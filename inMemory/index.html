<!DOCTYPE html>
<html class="h-100">
  <head>
    <meta charset="UTF-8" />
    <title>OWASP in-memory storage</title>
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/monokai-sublime.min.css"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.7.2/css/solid.css"
      integrity="sha384-r/k8YTFqmlOaqRkZuSiE9trsrDXkh07mRaoGBMoDcmA58OHILZPsk29i2BsFng1B"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.7.2/css/fontawesome.css"
      integrity="sha384-4aon80D8rXCGx9ayDt85LbyUHeMWd3UiBaWliBlJ53yzm9hqN21A+o1pqoyK04h+"
      crossorigin="anonymous"
    />
    <link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.1/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.3.1/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
  <body>
    <div id="main-content" class="container-xl mt-5 flex-grow-1">
      <div id="content-home" class="page">
        <div class="text-center hero">
          <h1 class="mb-4">In memory storage showcase</h1>
          <p class="lead" >
            This is a sample application that demonstrates different in-memory
            storage implementations and their insecurities against XSS.
          </p>
          <hr style="margin:20px">
          <div class="container-xl">
            <div class="row">
              <div class="col-xl-8">
                <div class="container-xl">
                  <div class="row">
                    <div class="col-lg">
                      <p> Secret stored in-memory in a "secret_1" variable </p>
                      <input type="text" id="secret1" name="secret1" height=50 />
                      <button onClick=storeInMemory()> Submit secret </button>
                    </div>
                    <div class="col-lg">
                      <pre style="font-size:16px;text-align:left"/>
                        <code id="inMemoryFn" class="javascript"></code>
                      </pre>
                    </div>
                  </div>
                </div>
                <hr style="margin:20px">
                <div class="container-xl">
                  <div class="row">
                    <div class="col-lg">
                      <p> Secret stored in-memory in a "data.secret" key in the data object</p>
                      <input type="text" id="secret2" name="secret2" height=50>
                      <button onClick=storeInMemory2()> Submit secret </button>
                    </div>
                    <div class="col-lg">
                      <pre style="font-size:16px;text-align:left"/>
                        <code id="inMemoryFn2" class="javascript"></code>
                      </pre>
                    </div>
                  </div>
                </div>
                <hr style="margin:20px">
                <div class="container-xl">
                  <div class="row">
                    <div class="col-lg">
                      <p> Fetch secret from backend and store in an in-closure variable </p>
                      <button onClick=backendSecret.value()> Fetch secret </button>
                    </div>
                    <div class="col-lg">
                      <pre style="font-size:16px;text-align:left"/>
                        <code id="fetchSecretFn" class="javascript"></code>
                      </pre>
                    </div>
                  </div>
                </div>
                <hr style="margin:20px">
                <div class="container-xl">
                  <div class="row">
                    <div class="col-lg">
                      <p> Fetch secret from backend and store in an in-closure variable. Local copy of fetch within the closure </p>
                      <button onClick=localBackendSecret.value()> Fetch secret </button>
                    </div>
                    <div class="col-lg">
                      <pre style="font-size:16px;text-align:left">
                        <code id="localFetchSecretFn" class="javascript"></code>
                      </pre>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-xl-4" style="text-align:center;margin-top: 10%">
                <form id="xssform">
                  <label>XSS payload
                    <br>
                    <textarea rows = "5" cols = "45" id='payload' />  <img src='x' onerror='alert(1);'/></textarea>
                  </label>
                  <br>
                  <button type="submit">Submit XSS</button>
                </form>
                <p id="xss"></p>
              </div>
            </div>
          </div>
          <hr style="margin:20px">
          <div class="row">
            <div class="col-lg"/>
            <div class="col-lg">
          <div/>
        </div>
      </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
    <script src="app.js"></script>
  </body>
</html>
